{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport jwt from \"jwt-decode\";\nexport function SalvarJWT(_x) {\n  return _SalvarJWT.apply(this, arguments);\n}\nfunction _SalvarJWT() {\n  _SalvarJWT = _asyncToGenerator(function* (jwtData) {\n    debugger;\n    console.log('executou o salvar jwt');\n    var userData = jwt(jwtData);\n    yield AsyncStorage.setItem(\"@jwt\", jwtData);\n    yield AsyncStorage.setItem(\"@userData\", JSON.stringify(userData));\n  });\n  return _SalvarJWT.apply(this, arguments);\n}\nexport function HeaderRequisicao() {\n  return _HeaderRequisicao.apply(this, arguments);\n}\nfunction _HeaderRequisicao() {\n  _HeaderRequisicao = _asyncToGenerator(function* () {\n    var usuarioLogado = yield ChecarLoginUsuario();\n    if (usuarioLogado == false) {}\n    var token = yield AsyncStorage.getItem(\"@jwt\");\n    return new Headers({\n      Authorization: \"Bearer \" + token,\n      \"Content-Type\": \"application/json\"\n    });\n  });\n  return _HeaderRequisicao.apply(this, arguments);\n}\nexport function ChecarLoginUsuario() {\n  return _ChecarLoginUsuario.apply(this, arguments);\n}\nfunction _ChecarLoginUsuario() {\n  _ChecarLoginUsuario = _asyncToGenerator(function* () {\n    var token = yield AsyncStorage.getItem(\"@jwt\");\n    console.log(token);\n    if (!token) {\n      return false;\n    }\n    var userData = JSON.parse(yield AsyncStorage.getItem(\"@userData\"));\n    var actualDate = Date.parse(new Date()) / 1000;\n    if (actualDate > userData.exp) {\n      yield AsyncStorage.remove(\"@jwt\");\n      return false;\n    }\n    return true;\n  });\n  return _ChecarLoginUsuario.apply(this, arguments);\n}","map":{"version":3,"names":["AsyncStorage","jwt","SalvarJWT","_x","_SalvarJWT","apply","arguments","_asyncToGenerator","jwtData","console","log","userData","setItem","JSON","stringify","HeaderRequisicao","_HeaderRequisicao","usuarioLogado","ChecarLoginUsuario","token","getItem","Headers","Authorization","_ChecarLoginUsuario","parse","actualDate","Date","exp","remove"],"sources":["C:/Users/luizf/Desktop/App_Cuidadores6/src/AuthContext.js"],"sourcesContent":["import AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport jwt from \"jwt-decode\";\n\nexport async function SalvarJWT(jwtData) {\n  debugger;\n  console.log('executou o salvar jwt')\n  const userData = jwt(jwtData);\n\n  await AsyncStorage.setItem(\"@jwt\", jwtData);\n  await AsyncStorage.setItem(\"@userData\", JSON.stringify(userData));\n}\n\nexport async function HeaderRequisicao() {\nconst usuarioLogado = await ChecarLoginUsuario();\n\nif(usuarioLogado==false){\n  // Navegar('Login')\n}\n\n  const token = await AsyncStorage.getItem(\"@jwt\");\n  return new Headers({\n    Authorization: \"Bearer \" + token,\n    \"Content-Type\": \"application/json\",\n  });\n}\n\nexport async function ChecarLoginUsuario() {\n  \n  //Verificar se tem o tokem armarzenado\n  const token = await AsyncStorage.getItem(\"@jwt\");\n  console.log(token);\n\n  if (!token) {\n    return false;\n  }\n\n  //Pega os dados do usuario logado\n  const userData = JSON.parse(await AsyncStorage.getItem(\"@userData\"));\n  \n  //DEtermina o tempo que o usuario fica logado\n  const actualDate = Date.parse(new Date()) / 1000;\n\n  if (actualDate > userData.exp) {\n    //usuario expirado\n    await AsyncStorage.remove(\"@jwt\");\n    return false;\n  }\n\n  return true;\n}\n"],"mappings":";AAAA,OAAOA,YAAY,MAAM,2CAA2C;AACpE,OAAOC,GAAG,MAAM,YAAY;AAE5B,gBAAsBC,SAASA,CAAAC,EAAA;EAAA,OAAAC,UAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA;AAO9B,SAAAF,WAAA;EAAAA,UAAA,GAAAG,iBAAA,CAPM,WAAyBC,OAAO,EAAE;IACvC;IACAC,OAAO,CAACC,GAAG,CAAC,uBAAuB,CAAC;IACpC,IAAMC,QAAQ,GAAGV,GAAG,CAACO,OAAO,CAAC;IAE7B,MAAMR,YAAY,CAACY,OAAO,CAAC,MAAM,EAAEJ,OAAO,CAAC;IAC3C,MAAMR,YAAY,CAACY,OAAO,CAAC,WAAW,EAAEC,IAAI,CAACC,SAAS,CAACH,QAAQ,CAAC,CAAC;EACnE,CAAC;EAAA,OAAAP,UAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA;AAED,gBAAsBS,gBAAgBA,CAAA;EAAA,OAAAC,iBAAA,CAAAX,KAAA,OAAAC,SAAA;AAAA;AAYrC,SAAAU,kBAAA;EAAAA,iBAAA,GAAAT,iBAAA,CAZM,aAAkC;IACzC,IAAMU,aAAa,SAASC,kBAAkB,EAAE;IAEhD,IAAGD,aAAa,IAAE,KAAK,EAAC,CAExB;IAEE,IAAME,KAAK,SAASnB,YAAY,CAACoB,OAAO,CAAC,MAAM,CAAC;IAChD,OAAO,IAAIC,OAAO,CAAC;MACjBC,aAAa,EAAE,SAAS,GAAGH,KAAK;MAChC,cAAc,EAAE;IAClB,CAAC,CAAC;EACJ,CAAC;EAAA,OAAAH,iBAAA,CAAAX,KAAA,OAAAC,SAAA;AAAA;AAED,gBAAsBY,kBAAkBA,CAAA;EAAA,OAAAK,mBAAA,CAAAlB,KAAA,OAAAC,SAAA;AAAA;AAuBvC,SAAAiB,oBAAA;EAAAA,mBAAA,GAAAhB,iBAAA,CAvBM,aAAoC;IAGzC,IAAMY,KAAK,SAASnB,YAAY,CAACoB,OAAO,CAAC,MAAM,CAAC;IAChDX,OAAO,CAACC,GAAG,CAACS,KAAK,CAAC;IAElB,IAAI,CAACA,KAAK,EAAE;MACV,OAAO,KAAK;IACd;IAGA,IAAMR,QAAQ,GAAGE,IAAI,CAACW,KAAK,OAAOxB,YAAY,CAACoB,OAAO,CAAC,WAAW,CAAC,CAAC;IAGpE,IAAMK,UAAU,GAAGC,IAAI,CAACF,KAAK,CAAC,IAAIE,IAAI,EAAE,CAAC,GAAG,IAAI;IAEhD,IAAID,UAAU,GAAGd,QAAQ,CAACgB,GAAG,EAAE;MAE7B,MAAM3B,YAAY,CAAC4B,MAAM,CAAC,MAAM,CAAC;MACjC,OAAO,KAAK;IACd;IAEA,OAAO,IAAI;EACb,CAAC;EAAA,OAAAL,mBAAA,CAAAlB,KAAA,OAAAC,SAAA;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}