{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport jwt from \"jwt-decode\";\nexport function SalvarJWT(_x) {\n  return _SalvarJWT.apply(this, arguments);\n}\nfunction _SalvarJWT() {\n  _SalvarJWT = _asyncToGenerator(function* (jwtData) {\n    console.log('executou o salvar jwt');\n    var userData = jwt(jwtData);\n    yield AsyncStorage.setItem(\"@jwt\", jwtData);\n    yield AsyncStorage.setItem(\"@userData\", JSON.stringify(userData));\n  });\n  return _SalvarJWT.apply(this, arguments);\n}\nexport function HeaderRequisicao() {\n  return _HeaderRequisicao.apply(this, arguments);\n}\nfunction _HeaderRequisicao() {\n  _HeaderRequisicao = _asyncToGenerator(function* () {\n    var usuarioLogado = yield ChecarLoginUsuario();\n    if (usuarioLogado == false) {}\n    var token = yield AsyncStorage.getItem(\"@jwt\");\n    return new Headers({\n      \"Authorization\": \"Bearer \" + token,\n      \"Content-Type\": \"application/json\"\n    });\n  });\n  return _HeaderRequisicao.apply(this, arguments);\n}\nexport function ChecarLoginUsuario() {\n  return _ChecarLoginUsuario.apply(this, arguments);\n}\nfunction _ChecarLoginUsuario() {\n  _ChecarLoginUsuario = _asyncToGenerator(function* () {\n    var token = yield AsyncStorage.getItem(\"@jwt\");\n    console.log(token);\n    if (!token) {\n      return false;\n    }\n    var userData = JSON.parse(yield AsyncStorage.getItem(\"@userData\"));\n    var actualDate = Date.parse(new Date()) / 1000;\n    if (actualDate > userData.exp) {\n      yield AsyncStorage.remove(\"@jwt\");\n      return false;\n    }\n    return true;\n  });\n  return _ChecarLoginUsuario.apply(this, arguments);\n}\nexport function DadosUsuario() {\n  return _DadosUsuario.apply(this, arguments);\n}\nfunction _DadosUsuario() {\n  _DadosUsuario = _asyncToGenerator(function* () {\n    return JSON.parse(yield AsyncStorage.getItem(\"@userData\"));\n  });\n  return _DadosUsuario.apply(this, arguments);\n}","map":{"version":3,"names":["AsyncStorage","jwt","SalvarJWT","_x","_SalvarJWT","apply","arguments","_asyncToGenerator","jwtData","console","log","userData","setItem","JSON","stringify","HeaderRequisicao","_HeaderRequisicao","usuarioLogado","ChecarLoginUsuario","token","getItem","Headers","_ChecarLoginUsuario","parse","actualDate","Date","exp","remove","DadosUsuario","_DadosUsuario"],"sources":["C:/Users/luizf/Desktop/App_Cuidadores2_On/src/AuthContext.js"],"sourcesContent":["import AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport jwt from \"jwt-decode\";\n\nexport async function SalvarJWT(jwtData) {\n  //debugger;\n  console.log('executou o salvar jwt')\n  const userData = jwt(jwtData);\n\n  await AsyncStorage.setItem(\"@jwt\", jwtData);\n  await AsyncStorage.setItem(\"@userData\", JSON.stringify(userData));\n}\n\nexport async function HeaderRequisicao() {\n  const usuarioLogado = await ChecarLoginUsuario();\n\n  if (usuarioLogado == false) {\n    // Navegar('Login')\n  }\n\n  const token = await AsyncStorage.getItem(\"@jwt\");\n\n  return new Headers({\n    \"Authorization\": \"Bearer \" + token,\n    \"Content-Type\": \"application/json\",\n  });\n}\n\nexport async function ChecarLoginUsuario() {\n\n  //Verificar se tem o tokem armarzenado\n  const token = await AsyncStorage.getItem(\"@jwt\");\n  console.log(token);\n\n  if (!token) {\n    return false;\n  }\n\n  //Pega os dados do usuario logado\n  const userData = JSON.parse(await AsyncStorage.getItem(\"@userData\"));\n\n  //DEtermina o tempo que o usuario fica logado\n  const actualDate = Date.parse(new Date()) / 1000;\n\n  if (actualDate > userData.exp) {\n    //usuario expirado\n    await AsyncStorage.remove(\"@jwt\");\n    return false;\n  }\n\n  return true;\n}\n\nexport async function DadosUsuario() {\n  return JSON.parse(await AsyncStorage.getItem(\"@userData\"));\n}"],"mappings":";AAAA,OAAOA,YAAY,MAAM,2CAA2C;AACpE,OAAOC,GAAG,MAAM,YAAY;AAE5B,gBAAsBC,SAASA,CAAAC,EAAA;EAAA,OAAAC,UAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA;AAO9B,SAAAF,WAAA;EAAAA,UAAA,GAAAG,iBAAA,CAPM,WAAyBC,OAAO,EAAE;IAEvCC,OAAO,CAACC,GAAG,CAAC,uBAAuB,CAAC;IACpC,IAAMC,QAAQ,GAAGV,GAAG,CAACO,OAAO,CAAC;IAE7B,MAAMR,YAAY,CAACY,OAAO,CAAC,MAAM,EAAEJ,OAAO,CAAC;IAC3C,MAAMR,YAAY,CAACY,OAAO,CAAC,WAAW,EAAEC,IAAI,CAACC,SAAS,CAACH,QAAQ,CAAC,CAAC;EACnE,CAAC;EAAA,OAAAP,UAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA;AAED,gBAAsBS,gBAAgBA,CAAA;EAAA,OAAAC,iBAAA,CAAAX,KAAA,OAAAC,SAAA;AAAA;AAarC,SAAAU,kBAAA;EAAAA,iBAAA,GAAAT,iBAAA,CAbM,aAAkC;IACvC,IAAMU,aAAa,SAASC,kBAAkB,EAAE;IAEhD,IAAID,aAAa,IAAI,KAAK,EAAE,CAE5B;IAEA,IAAME,KAAK,SAASnB,YAAY,CAACoB,OAAO,CAAC,MAAM,CAAC;IAEhD,OAAO,IAAIC,OAAO,CAAC;MACjB,eAAe,EAAE,SAAS,GAAGF,KAAK;MAClC,cAAc,EAAE;IAClB,CAAC,CAAC;EACJ,CAAC;EAAA,OAAAH,iBAAA,CAAAX,KAAA,OAAAC,SAAA;AAAA;AAED,gBAAsBY,kBAAkBA,CAAA;EAAA,OAAAI,mBAAA,CAAAjB,KAAA,OAAAC,SAAA;AAAA;AAuBvC,SAAAgB,oBAAA;EAAAA,mBAAA,GAAAf,iBAAA,CAvBM,aAAoC;IAGzC,IAAMY,KAAK,SAASnB,YAAY,CAACoB,OAAO,CAAC,MAAM,CAAC;IAChDX,OAAO,CAACC,GAAG,CAACS,KAAK,CAAC;IAElB,IAAI,CAACA,KAAK,EAAE;MACV,OAAO,KAAK;IACd;IAGA,IAAMR,QAAQ,GAAGE,IAAI,CAACU,KAAK,OAAOvB,YAAY,CAACoB,OAAO,CAAC,WAAW,CAAC,CAAC;IAGpE,IAAMI,UAAU,GAAGC,IAAI,CAACF,KAAK,CAAC,IAAIE,IAAI,EAAE,CAAC,GAAG,IAAI;IAEhD,IAAID,UAAU,GAAGb,QAAQ,CAACe,GAAG,EAAE;MAE7B,MAAM1B,YAAY,CAAC2B,MAAM,CAAC,MAAM,CAAC;MACjC,OAAO,KAAK;IACd;IAEA,OAAO,IAAI;EACb,CAAC;EAAA,OAAAL,mBAAA,CAAAjB,KAAA,OAAAC,SAAA;AAAA;AAED,gBAAsBsB,YAAYA,CAAA;EAAA,OAAAC,aAAA,CAAAxB,KAAA,OAAAC,SAAA;AAAA;AAEjC,SAAAuB,cAAA;EAAAA,aAAA,GAAAtB,iBAAA,CAFM,aAA8B;IACnC,OAAOM,IAAI,CAACU,KAAK,OAAOvB,YAAY,CAACoB,OAAO,CAAC,WAAW,CAAC,CAAC;EAC5D,CAAC;EAAA,OAAAS,aAAA,CAAAxB,KAAA,OAAAC,SAAA;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}